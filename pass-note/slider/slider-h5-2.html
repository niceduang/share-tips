<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Document</title>
	<style type="text/css">
		*{margin: 0;padding: 0;}
		li{list-style: none;}
		#tabPic{ overflow:hidden; position:relative;width: 500px;margin: 0 auto;}
		#picList{
			overflow:hidden;
			width:2500px;
		}
		#picList li{float:left; width:500px;height: 300px;background-color: #f90;text-align: center;line-height: 300px;font-size: 100px;}
		.picMask{height:102px; position:absolute;left:0;bottom:0;width:100%; background:-webkit-linear-gradient(bottom,rgba(0,0,0,0.9) 0,rgba(0,0,0,0.8) 10%,rgba(0,0,0,0));background:linear-gradient(bottom,rgba(0,0,0,0.9) 0,rgba(0,0,0,0.8) 20%,rgba(0,0,0,0));}
		.picMask nav{height:10px; right:26px; top:56px; position:absolute;}
		.picMask nav a{float:left;width:10px;height:10px; border-radius:5px;background:#fff; opacity:0.5;margin-left:15px;}
		.picMask nav a.active{ opacity:1;}
	</style>
</head>
<body>
	<section id="tabPic">
	    <ul id="picList">
	        <li>1</li>
	        <li>2</li>
	        <li>3</li>
	        <li>4</li>
	        <li>5</li>
	    </ul>
	    <section class="picMask">
	        <nav>
	            <a href="javascript:;" class="active"></a>
	            <a href="javascript:;"></a>
	            <a href="javascript:;"></a>
	            <a href="javascript:;"></a>
	            <a href="javascript:;"></a>
	        </nav>
	    </section>
	</section>
	<script src="http://ossweb-img.qq.com/images/js/jquery/jquery-1.11.3.min.js"></script>
	<script type="text/javascript">
		function bind(obj, ev, fn) { 
	        obj.addEventListener&&obj.addEventListener(ev, fn, false);
		}
		fnTab();
		function fnTab() {
			var oTab = document.querySelector("#tabPic");
			var oList = document.querySelector("#picList");
			var aLis = document.querySelectorAll("#picList li");
			var len = aLis.length;
			var aNav = oTab.getElementsByTagName("nav")[0].children;
			var iNow = 0;
			var iX = 0;
			var iW = 500;
			var oTimer = 0;
			var iStartTouchX = 0;
			var iStartX = 0;
			var loop = true;
			function resetHtml(){
				if (!loop) {return;}
				var liFirst = $('#picList li:first');
				var liLast = $('#picList li:last');
				$('#picList').append(liFirst.clone(true)).prepend(liLast.clone(true));
				iX = -500;
				$('#picList').css({
					'width': iW * $('#picList li').length,
					'transform':'translateX('+(iX)+'px)'
				});
			}
			resetHtml();

			bind(oTab, "touchstart", fnStart);
			bind(oTab, "touchmove", fnMove);
			bind(oTab, "touchend", fnEnd);
			// auto();

			function auto() {
				oTimer = setInterval(function() {
					iNow++;
					iNow = iNow % aNav.length;
					tab();
				}, 2000);
			}

			function fnStart(ev) {
				oList.style.transition = "none";
				ev = ev.changedTouches[0];
				iStartTouchX = ev.pageX;
				iStartX = iX;
				oTimer&&clearInterval(oTimer);
			}

			function fnMove(ev) {
				ev = ev.changedTouches[0];
				var iDis = ev.pageX - iStartTouchX;
				iX = iStartX + iDis;
				oList.style.WebkitTransform = oList.style.transform = "translateX(" + iX + "px)";
			}

			function fnEnd() {
				iNow = (iX+iW) / iW;
				iNow = -Math.round(iNow);
				
				if (iNow < 0) {
					iNow = 0;
				}
				if (iNow > aNav.length - 1) {
					iNow = aNav.length - 1;
				}
				console.log(iNow);
				tab();
				// auto();
			}

			function tab() {
				iX = -iNow * iW - iW;
				oList.style.transition = "0.5s";
				oList.style.WebkitTransform = oList.style.transform = "translateX(" + iX + "px)";
				for (var i = 0; i < aNav.length; i++) {
					aNav[i].classList.remove("active");
				}
				aNav[iNow].classList.add("active");
			}
		}
	</script>
</body>
</html>