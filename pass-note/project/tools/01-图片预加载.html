<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Document</title>
</head>
<body>
<script type="text/javascript">
	/**
	 * [参见](http://expelliarmus923.github.io/2016/03/25/JavaScript%E5%9B%BE%E7%89%87%E9%A2%84%E5%8A%A0%E8%BD%BD/)
	 */
	// 常见的方案是
	function preloadImg(url){
		var img = new Image();
		img.src = url;
		if(img.complete){
			//图片有缓存，执行一些函数。。。。
		}else{
			img.onload = function(){
				//图片加载完成，执行一些函数。。。。
			};
		}
	}
	// 多图片加强版
	var ImgPreLoad = (function() {
	    return function(URL, Loadfn) {
	        var ImgPreLoad = function(url) {
	            var img = new Image();
	            img.src = url;
	            if (img.complete) {
	                Loadfn.call(this);
	                // console.log("complete!");
	            } else {
	                img.onload = function() {
	                    Loadfn.call(this);
	                    // console.log("onload!");
	                }
	                img.onerror = function() {
	                    console.log("图片加载失败!");
	                }
	            }
	        };
	        (function() {
	            if (URL instanceof Array) {
	                for (var index = 0; index < URL.length; index++)
	                    ImgPreLoad(URL[index]);
	            } else return console.log("URL不是数组")
	        })()
	    }
	})();
	// 目前用
	// loading
	var imgPath = './images/',
	    sourceArr = ['spr.png','a.jpg'];
	    for (var i = 0; i < sourceArr.length; i++) {
	        sourceArr[i] = imgPath + sourceArr[i];
	    }
	var loadImage = function(path, callback) {
	    var img = new Image();
	    img.onload = function() {
	        img.onload = null;
	        callback(path);
	    }
	    img.src = path;
	}
	var imgLoader = function(imgs, callback) {
	    var len = imgs.length,
	        i = 0;
	    while (imgs.length) {
	        loadImage(imgs.shift(), function(path) {
	            callback(path, ++i, len);
	        });
	    }
	}
	imgLoader(sourceArr, function(path, curNum, total) {
	    var percent = curNum / total;
	    // console.log(percent);
	    $('.ldpt span').html(Math.floor(percent * 100));
	    $('.ldbar').css('width',Math.floor(percent * 100)+'%');
	    if (percent == 1) {
	        $('.loading').css('display','none');
	        $('.container').css('display','block');
	    }
	});
</script>
</body>
</html>